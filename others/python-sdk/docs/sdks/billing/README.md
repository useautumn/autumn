# Billing

## Overview

### Available Operations

* [attach](#attach) - Attaches a plan to a customer. Handles new subscriptions, upgrades and downgrades.
* [preview_attach](#preview_attach) - Preview billing changes before attaching a plan.
* [update](#update) - Update an existing subscription.
* [preview_update](#preview_update) - Preview billing changes before updating a subscription.
* [setup_payment](#setup_payment) - Create a setup payment session for a customer.

## attach

Attaches a plan to a customer. Handles new subscriptions, upgrades and downgrades.

### Example Usage

<!-- UsageSnippet language="python" operationID="billingAttach" method="post" path="/v1/billing.attach" -->
```python
from autumn_sdk import Autumn


with Autumn(
    x_api_version="2.1",
    secret_key="<YOUR_BEARER_TOKEN_HERE>",
) as autumn:

    res = autumn.billing.attach(customer_id="<id>", plan_id="<id>", redirect_mode="always")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                              | Type                                                                                                                                                                                                   | Required                                                                                                                                                                                               | Description                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `customer_id`                                                                                                                                                                                          | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | The ID of the customer to attach the plan to.                                                                                                                                                          |
| `plan_id`                                                                                                                                                                                              | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `entity_id`                                                                                                                                                                                            | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | The ID of the entity to attach the plan to.                                                                                                                                                            |
| `feature_quantities`                                                                                                                                                                                   | List[[models.BillingAttachFeatureQuantities](../../models/billingattachfeaturequantities.md)]                                                                                                          | :heavy_minus_sign:                                                                                                                                                                                     | If this plan contains prepaid features, use this field to specify the quantity of each prepaid feature. This quantity includes the included amount and billing units defined when setting up the plan. |
| `version`                                                                                                                                                                                              | *Optional[float]*                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `free_trial`                                                                                                                                                                                           | [OptionalNullable[models.BillingAttachFreeTrial]](../../models/billingattachfreetrial.md)                                                                                                              | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `customize`                                                                                                                                                                                            | [Optional[models.BillingAttachCustomize]](../../models/billingattachcustomize.md)                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `invoice_mode`                                                                                                                                                                                         | [Optional[models.BillingAttachInvoiceMode]](../../models/billingattachinvoicemode.md)                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `discounts`                                                                                                                                                                                            | List[[models.BillingAttachDiscountUnion](../../models/billingattachdiscountunion.md)]                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `redirect_mode`                                                                                                                                                                                        | [Optional[models.BillingAttachRedirectMode]](../../models/billingattachredirectmode.md)                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `success_url`                                                                                                                                                                                          | *Optional[str]*                                                                                                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `new_billing_subscription`                                                                                                                                                                             | *Optional[bool]*                                                                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `plan_schedule`                                                                                                                                                                                        | [Optional[models.BillingAttachPlanSchedule]](../../models/billingattachplanschedule.md)                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `billing_behavior`                                                                                                                                                                                     | [Optional[models.BillingAttachBillingBehavior]](../../models/billingattachbillingbehavior.md)                                                                                                          | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `retries`                                                                                                                                                                                              | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | Configuration to override the default retry behavior of the client.                                                                                                                                    |

### Response

**[models.BillingAttachResponse](../../models/billingattachresponse.md)**

### Errors

| Error Type                | Status Code               | Content Type              |
| ------------------------- | ------------------------- | ------------------------- |
| errors.AutumnDefaultError | 4XX, 5XX                  | \*/\*                     |

## preview_attach

Preview billing changes before attaching a plan.

### Example Usage

<!-- UsageSnippet language="python" operationID="billingPreviewAttach" method="post" path="/v1/billing.preview_attach" -->
```python
from autumn_sdk import Autumn


with Autumn(
    x_api_version="2.1",
    secret_key="<YOUR_BEARER_TOKEN_HERE>",
) as autumn:

    res = autumn.billing.preview_attach(customer_id="<id>", plan_id="<id>", redirect_mode="always")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                              | Type                                                                                                                                                                                                   | Required                                                                                                                                                                                               | Description                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `customer_id`                                                                                                                                                                                          | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | The ID of the customer to attach the plan to.                                                                                                                                                          |
| `plan_id`                                                                                                                                                                                              | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `entity_id`                                                                                                                                                                                            | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | The ID of the entity to attach the plan to.                                                                                                                                                            |
| `feature_quantities`                                                                                                                                                                                   | List[[models.BillingPreviewAttachFeatureQuantities](../../models/billingpreviewattachfeaturequantities.md)]                                                                                            | :heavy_minus_sign:                                                                                                                                                                                     | If this plan contains prepaid features, use this field to specify the quantity of each prepaid feature. This quantity includes the included amount and billing units defined when setting up the plan. |
| `version`                                                                                                                                                                                              | *Optional[float]*                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `free_trial`                                                                                                                                                                                           | [OptionalNullable[models.BillingPreviewAttachFreeTrial]](../../models/billingpreviewattachfreetrial.md)                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `customize`                                                                                                                                                                                            | [Optional[models.BillingPreviewAttachCustomize]](../../models/billingpreviewattachcustomize.md)                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `invoice_mode`                                                                                                                                                                                         | [Optional[models.BillingPreviewAttachInvoiceMode]](../../models/billingpreviewattachinvoicemode.md)                                                                                                    | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `discounts`                                                                                                                                                                                            | List[[models.BillingPreviewAttachDiscountUnion](../../models/billingpreviewattachdiscountunion.md)]                                                                                                    | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `redirect_mode`                                                                                                                                                                                        | [Optional[models.BillingPreviewAttachRedirectMode]](../../models/billingpreviewattachredirectmode.md)                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `success_url`                                                                                                                                                                                          | *Optional[str]*                                                                                                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `new_billing_subscription`                                                                                                                                                                             | *Optional[bool]*                                                                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `plan_schedule`                                                                                                                                                                                        | [Optional[models.BillingPreviewAttachPlanSchedule]](../../models/billingpreviewattachplanschedule.md)                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `billing_behavior`                                                                                                                                                                                     | [Optional[models.BillingPreviewAttachBillingBehavior]](../../models/billingpreviewattachbillingbehavior.md)                                                                                            | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `retries`                                                                                                                                                                                              | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | Configuration to override the default retry behavior of the client.                                                                                                                                    |

### Response

**[models.BillingPreviewAttachResponse](../../models/billingpreviewattachresponse.md)**

### Errors

| Error Type                | Status Code               | Content Type              |
| ------------------------- | ------------------------- | ------------------------- |
| errors.AutumnDefaultError | 4XX, 5XX                  | \*/\*                     |

## update

Update an existing subscription.

### Example Usage

<!-- UsageSnippet language="python" operationID="billingUpdate" method="post" path="/v1/billing.update" -->
```python
from autumn_sdk import Autumn


with Autumn(
    x_api_version="2.1",
    secret_key="<YOUR_BEARER_TOKEN_HERE>",
) as autumn:

    res = autumn.billing.update(customer_id="<id>")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                              | Type                                                                                                                                                                                                   | Required                                                                                                                                                                                               | Description                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `customer_id`                                                                                                                                                                                          | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | The ID of the customer to attach the plan to.                                                                                                                                                          |
| `entity_id`                                                                                                                                                                                            | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | The ID of the entity to attach the plan to.                                                                                                                                                            |
| `feature_quantities`                                                                                                                                                                                   | List[[models.BillingUpdateFeatureQuantities](../../models/billingupdatefeaturequantities.md)]                                                                                                          | :heavy_minus_sign:                                                                                                                                                                                     | If this plan contains prepaid features, use this field to specify the quantity of each prepaid feature. This quantity includes the included amount and billing units defined when setting up the plan. |
| `version`                                                                                                                                                                                              | *Optional[float]*                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `free_trial`                                                                                                                                                                                           | [OptionalNullable[models.BillingUpdateFreeTrial]](../../models/billingupdatefreetrial.md)                                                                                                              | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `customize`                                                                                                                                                                                            | [Optional[models.BillingUpdateCustomize]](../../models/billingupdatecustomize.md)                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `plan_id`                                                                                                                                                                                              | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `invoice_mode`                                                                                                                                                                                         | [Optional[models.BillingUpdateInvoiceMode]](../../models/billingupdateinvoicemode.md)                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `cancel_action`                                                                                                                                                                                        | [Optional[models.BillingUpdateCancelAction]](../../models/billingupdatecancelaction.md)                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `billing_behavior`                                                                                                                                                                                     | [Optional[models.BillingUpdateBillingBehavior]](../../models/billingupdatebillingbehavior.md)                                                                                                          | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `retries`                                                                                                                                                                                              | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | Configuration to override the default retry behavior of the client.                                                                                                                                    |

### Response

**[models.BillingUpdateResponse](../../models/billingupdateresponse.md)**

### Errors

| Error Type                | Status Code               | Content Type              |
| ------------------------- | ------------------------- | ------------------------- |
| errors.AutumnDefaultError | 4XX, 5XX                  | \*/\*                     |

## preview_update

Preview billing changes before updating a subscription.

### Example Usage

<!-- UsageSnippet language="python" operationID="billingPreviewUpdate" method="post" path="/v1/billing.preview_update" -->
```python
from autumn_sdk import Autumn


with Autumn(
    x_api_version="2.1",
    secret_key="<YOUR_BEARER_TOKEN_HERE>",
) as autumn:

    res = autumn.billing.preview_update(customer_id="<id>")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                              | Type                                                                                                                                                                                                   | Required                                                                                                                                                                                               | Description                                                                                                                                                                                            |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `customer_id`                                                                                                                                                                                          | *str*                                                                                                                                                                                                  | :heavy_check_mark:                                                                                                                                                                                     | The ID of the customer to attach the plan to.                                                                                                                                                          |
| `entity_id`                                                                                                                                                                                            | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | The ID of the entity to attach the plan to.                                                                                                                                                            |
| `feature_quantities`                                                                                                                                                                                   | List[[models.BillingPreviewUpdateFeatureQuantities](../../models/billingpreviewupdatefeaturequantities.md)]                                                                                            | :heavy_minus_sign:                                                                                                                                                                                     | If this plan contains prepaid features, use this field to specify the quantity of each prepaid feature. This quantity includes the included amount and billing units defined when setting up the plan. |
| `version`                                                                                                                                                                                              | *Optional[float]*                                                                                                                                                                                      | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `free_trial`                                                                                                                                                                                           | [OptionalNullable[models.BillingPreviewUpdateFreeTrial]](../../models/billingpreviewupdatefreetrial.md)                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `customize`                                                                                                                                                                                            | [Optional[models.BillingPreviewUpdateCustomize]](../../models/billingpreviewupdatecustomize.md)                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `plan_id`                                                                                                                                                                                              | *OptionalNullable[str]*                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `invoice_mode`                                                                                                                                                                                         | [Optional[models.BillingPreviewUpdateInvoiceMode]](../../models/billingpreviewupdateinvoicemode.md)                                                                                                    | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `cancel_action`                                                                                                                                                                                        | [Optional[models.BillingPreviewUpdateCancelAction]](../../models/billingpreviewupdatecancelaction.md)                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `billing_behavior`                                                                                                                                                                                     | [Optional[models.BillingPreviewUpdateBillingBehavior]](../../models/billingpreviewupdatebillingbehavior.md)                                                                                            | :heavy_minus_sign:                                                                                                                                                                                     | N/A                                                                                                                                                                                                    |
| `retries`                                                                                                                                                                                              | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                       | :heavy_minus_sign:                                                                                                                                                                                     | Configuration to override the default retry behavior of the client.                                                                                                                                    |

### Response

**[models.BillingPreviewUpdateResponse](../../models/billingpreviewupdateresponse.md)**

### Errors

| Error Type                | Status Code               | Content Type              |
| ------------------------- | ------------------------- | ------------------------- |
| errors.AutumnDefaultError | 4XX, 5XX                  | \*/\*                     |

## setup_payment

Create a setup payment session for a customer.

### Example Usage

<!-- UsageSnippet language="python" operationID="billingSetupPayment" method="post" path="/v1/billing.setup_payment" -->
```python
from autumn_sdk import Autumn


with Autumn(
    x_api_version="2.1",
    secret_key="<YOUR_BEARER_TOKEN_HERE>",
) as autumn:

    res = autumn.billing.setup_payment(customer_id="<id>")

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                     | Type                                                                                          | Required                                                                                      | Description                                                                                   |
| --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- |
| `customer_id`                                                                                 | *str*                                                                                         | :heavy_check_mark:                                                                            | The ID of the customer                                                                        |
| `success_url`                                                                                 | *Optional[str]*                                                                               | :heavy_minus_sign:                                                                            | URL to redirect to after successful payment setup. Must start with either http:// or https:// |
| `customer_data`                                                                               | [Optional[models.CustomerData]](../../models/customerdata.md)                                 | :heavy_minus_sign:                                                                            | Customer details to set when creating a customer                                              |
| `checkout_session_params`                                                                     | Dict[str, *Any*]                                                                              | :heavy_minus_sign:                                                                            | Additional parameters for the checkout session                                                |
| `retries`                                                                                     | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                              | :heavy_minus_sign:                                                                            | Configuration to override the default retry behavior of the client.                           |

### Response

**[models.BillingSetupPaymentResponse](../../models/billingsetuppaymentresponse.md)**

### Errors

| Error Type                | Status Code               | Content Type              |
| ------------------------- | ------------------------- | ------------------------- |
| errors.AutumnDefaultError | 4XX, 5XX                  | \*/\*                     |