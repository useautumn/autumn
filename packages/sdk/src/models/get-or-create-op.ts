/*
 * Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT.
 */

import * as z from "zod/v4-mini";
import { remap as remap$ } from "../lib/primitives.js";
import {
  CustomerExpand,
  CustomerExpand$outboundSchema,
} from "./customer-expand.js";

export type GetOrCreateGlobals = {
  xApiVersion?: string | undefined;
};

export type Vercel = {
  installationId: string;
  accessToken: string;
  accountId: string;
  customPaymentMethodId?: string | undefined;
};

export type Processors = {
  vercel?: Vercel | undefined;
};

export type InternalOptions = {
  /**
   * The group of products to attach to the customer
   */
  defaultGroup?: string | undefined;
  /**
   * Whether to disable default products
   */
  disableDefaults?: boolean | undefined;
};

export type GetOrCreateEntityData = {
  /**
   * The feature ID that this entity is associated with
   */
  featureId: string;
  /**
   * Name of the entity
   */
  name?: string | undefined;
};

export type GetOrCreateCustomerParams = {
  customerId: string | null;
  /**
   * Customer's name
   */
  name?: string | null | undefined;
  /**
   * Customer's email address
   */
  email?: string | null | undefined;
  /**
   * Unique identifier (eg, serial number) to detect duplicate customers and prevent free trial abuse
   */
  fingerprint?: string | null | undefined;
  /**
   * Additional metadata for the customer
   */
  metadata?: { [k: string]: any } | null | undefined;
  /**
   * Stripe customer ID if you already have one
   */
  stripeId?: string | null | undefined;
  /**
   * Whether to create the customer in Stripe
   */
  createInStripe?: boolean | undefined;
  /**
   * The ID of the free plan to auto-enable for the customer
   */
  autoEnablePlanId?: string | undefined;
  /**
   * External processors for the customer
   */
  processors?: Processors | null | undefined;
  /**
   * Whether to send email receipts to this customer
   */
  sendEmailReceipts?: boolean | undefined;
  internalOptions?: InternalOptions | undefined;
  /**
   * Customer expand options
   */
  expand?: Array<CustomerExpand> | undefined;
  entityId?: string | undefined;
  entityData?: GetOrCreateEntityData | undefined;
  id?: string | null | undefined;
  withAutumnId?: boolean | undefined;
};

/** @internal */
export type Vercel$Outbound = {
  installation_id: string;
  access_token: string;
  account_id: string;
  custom_payment_method_id?: string | undefined;
};

/** @internal */
export const Vercel$outboundSchema: z.ZodMiniType<Vercel$Outbound, Vercel> = z
  .pipe(
    z.object({
      installationId: z.string(),
      accessToken: z.string(),
      accountId: z.string(),
      customPaymentMethodId: z.optional(z.string()),
    }),
    z.transform((v) => {
      return remap$(v, {
        installationId: "installation_id",
        accessToken: "access_token",
        accountId: "account_id",
        customPaymentMethodId: "custom_payment_method_id",
      });
    }),
  );

export function vercelToJSON(vercel: Vercel): string {
  return JSON.stringify(Vercel$outboundSchema.parse(vercel));
}

/** @internal */
export type Processors$Outbound = {
  vercel?: Vercel$Outbound | undefined;
};

/** @internal */
export const Processors$outboundSchema: z.ZodMiniType<
  Processors$Outbound,
  Processors
> = z.object({
  vercel: z.optional(z.lazy(() => Vercel$outboundSchema)),
});

export function processorsToJSON(processors: Processors): string {
  return JSON.stringify(Processors$outboundSchema.parse(processors));
}

/** @internal */
export type InternalOptions$Outbound = {
  default_group?: string | undefined;
  disable_defaults?: boolean | undefined;
};

/** @internal */
export const InternalOptions$outboundSchema: z.ZodMiniType<
  InternalOptions$Outbound,
  InternalOptions
> = z.pipe(
  z.object({
    defaultGroup: z.optional(z.string()),
    disableDefaults: z.optional(z.boolean()),
  }),
  z.transform((v) => {
    return remap$(v, {
      defaultGroup: "default_group",
      disableDefaults: "disable_defaults",
    });
  }),
);

export function internalOptionsToJSON(
  internalOptions: InternalOptions,
): string {
  return JSON.stringify(InternalOptions$outboundSchema.parse(internalOptions));
}

/** @internal */
export type GetOrCreateEntityData$Outbound = {
  feature_id: string;
  name?: string | undefined;
};

/** @internal */
export const GetOrCreateEntityData$outboundSchema: z.ZodMiniType<
  GetOrCreateEntityData$Outbound,
  GetOrCreateEntityData
> = z.pipe(
  z.object({
    featureId: z.string(),
    name: z.optional(z.string()),
  }),
  z.transform((v) => {
    return remap$(v, {
      featureId: "feature_id",
    });
  }),
);

export function getOrCreateEntityDataToJSON(
  getOrCreateEntityData: GetOrCreateEntityData,
): string {
  return JSON.stringify(
    GetOrCreateEntityData$outboundSchema.parse(getOrCreateEntityData),
  );
}

/** @internal */
export type GetOrCreateCustomerParams$Outbound = {
  customer_id: string | null;
  name?: string | null | undefined;
  email?: string | null | undefined;
  fingerprint?: string | null | undefined;
  metadata?: { [k: string]: any } | null | undefined;
  stripe_id?: string | null | undefined;
  create_in_stripe?: boolean | undefined;
  auto_enable_plan_id?: string | undefined;
  processors?: Processors$Outbound | null | undefined;
  send_email_receipts?: boolean | undefined;
  internal_options?: InternalOptions$Outbound | undefined;
  expand?: Array<string> | undefined;
  entity_id?: string | undefined;
  entity_data?: GetOrCreateEntityData$Outbound | undefined;
  id?: string | null | undefined;
  with_autumn_id: boolean;
};

/** @internal */
export const GetOrCreateCustomerParams$outboundSchema: z.ZodMiniType<
  GetOrCreateCustomerParams$Outbound,
  GetOrCreateCustomerParams
> = z.pipe(
  z.object({
    customerId: z.nullable(z.string()),
    name: z.optional(z.nullable(z.string())),
    email: z.optional(z.nullable(z.string())),
    fingerprint: z.optional(z.nullable(z.string())),
    metadata: z.optional(z.nullable(z.record(z.string(), z.any()))),
    stripeId: z.optional(z.nullable(z.string())),
    createInStripe: z.optional(z.boolean()),
    autoEnablePlanId: z.optional(z.string()),
    processors: z.optional(z.nullable(z.lazy(() => Processors$outboundSchema))),
    sendEmailReceipts: z.optional(z.boolean()),
    internalOptions: z.optional(z.lazy(() => InternalOptions$outboundSchema)),
    expand: z.optional(z.array(CustomerExpand$outboundSchema)),
    entityId: z.optional(z.string()),
    entityData: z.optional(z.lazy(() => GetOrCreateEntityData$outboundSchema)),
    id: z.optional(z.nullable(z.string())),
    withAutumnId: z._default(z.boolean(), false),
  }),
  z.transform((v) => {
    return remap$(v, {
      customerId: "customer_id",
      stripeId: "stripe_id",
      createInStripe: "create_in_stripe",
      autoEnablePlanId: "auto_enable_plan_id",
      sendEmailReceipts: "send_email_receipts",
      internalOptions: "internal_options",
      entityId: "entity_id",
      entityData: "entity_data",
      withAutumnId: "with_autumn_id",
    });
  }),
);

export function getOrCreateCustomerParamsToJSON(
  getOrCreateCustomerParams: GetOrCreateCustomerParams,
): string {
  return JSON.stringify(
    GetOrCreateCustomerParams$outboundSchema.parse(getOrCreateCustomerParams),
  );
}
